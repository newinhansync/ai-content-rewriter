# RSS 구독 기능 개발 Task

> **기능 버전**: Feature-RSS v1.0
> **생성일**: 2025-12-29
> **관련 설계**: `docs/features/RSS-SUBSCRIPTION-DESIGN.md`
> **예상 태스크**: 25개

---

## 상태 범례

| 상태 | 표기 | 설명 |
|------|------|------|
| 대기 | ⬜ | 시작 가능 |
| 진행중 | 🔄 | 현재 작업 중 |
| 완료 | ✅ | 완료됨 |
| 차단됨 | 🚫 | 선행 작업 필요 |

---

## Phase R1: 데이터베이스 및 기본 구조 (5/5) ✅

### R1.1 데이터베이스 스키마 확장 ✅
> 의존성: 없음

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R1.1.1 | wp_aicr_feeds 테이블 스키마 정의 | ✅ | Schema.php 확장 |
| R1.1.2 | wp_aicr_feed_items 테이블 스키마 정의 | ✅ | 외래키 포함 |
| R1.1.3 | dbDelta 마이그레이션 추가 | ✅ | Activator.php 수정 |
| R1.1.4 | 테이블 생성 테스트 | ✅ | WP-CLI로 테스트 완료 |

**완료 기준**: 두 테이블이 정상 생성되고 외래키 제약 동작 확인

---

### R1.2 엔티티 클래스 생성 ✅
> 의존성: R1.1 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R1.2.1 | Feed 엔티티 클래스 | ✅ | `src/RSS/Feed.php` |
| R1.2.2 | FeedItem 엔티티 클래스 | ✅ | `src/RSS/FeedItem.php` |
| R1.2.3 | FeedStatus 열거형 | ✅ | Feed.php 상수로 구현 |
| R1.2.4 | ItemStatus 열거형 | ✅ | FeedItem.php 상수로 구현 |

**완료 기준**: 엔티티 인스턴스화 및 getter/setter 동작

---

### R1.3 Repository 클래스 생성 ✅
> 의존성: R1.2 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R1.3.1 | FeedRepository 클래스 | ✅ | CRUD 메서드 |
| R1.3.2 | FeedItemRepository 클래스 | ✅ | CRUD + 필터링 |
| R1.3.3 | 중복 방지 로직 (GUID) | ✅ | upsert 패턴 |
| R1.3.4 | 페이지네이션 지원 | ✅ | offset, limit |

**완료 기준**: DB CRUD 동작 및 중복 체크 확인

---

### R1.4 관리자 메뉴 확장 ✅
> 의존성: 없음

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R1.4.1 | RSS 피드 서브메뉴 추가 | ✅ | AdminMenu.php 수정 |
| R1.4.2 | 피드 리더 서브메뉴 추가 | ✅ | AdminMenu.php 수정 |
| R1.4.3 | 메뉴 순서 조정 | ✅ | 새 콘텐츠 다음 |
| R1.4.4 | 뷰 파일 생성 | ✅ | feeds.php, feed-reader.php |

**완료 기준**: 관리자 메뉴에 2개 서브메뉴 표시

---

### R1.5 설정 페이지 확장 ✅
> 의존성: R1.4 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R1.5.1 | RSS 설정 탭 추가 | ✅ | settings.php 수정 |
| R1.5.2 | 기본 갱신 주기 설정 | ✅ | 1시간/6시간/12시간/24시간 |
| R1.5.3 | 최대 아이템 보관 기간 설정 | ✅ | 7일/30일/90일 |
| R1.5.4 | 자동 재작성 글로벌 설정 | ✅ | on/off |

**완료 기준**: RSS 설정 탭 UI 렌더링 및 저장

---

## Phase R2: 피드 파싱 및 가져오기 (5/5) ✅

### R2.1 피드 파서 구현 ✅
> 의존성: R1.2 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R2.1.1 | FeedParser 클래스 생성 | ✅ | `src/RSS/FeedParser.php` |
| R2.1.2 | RSS 2.0 파싱 구현 | ✅ | SimplePie 사용 (WordPress 내장) |
| R2.1.3 | Atom 파싱 구현 | ✅ | SimplePie로 통합 |
| R2.1.4 | RSS 1.0 파싱 구현 | ✅ | SimplePie로 통합 |
| R2.1.5 | 피드 타입 자동 감지 | ✅ | SimplePie 자동 감지 |
| R2.1.6 | 인코딩 처리 | ✅ | SimplePie 자동 처리 |

**완료 기준**: 샘플 RSS/Atom 피드 파싱 성공

---

### R2.2 피드 가져오기 구현 ✅
> 의존성: R2.1 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R2.2.1 | FeedFetcher 클래스 생성 | ✅ | `src/RSS/FeedFetcher.php` |
| R2.2.2 | HTTP 요청 (wp_remote_get) | ✅ | SimplePie + fetch_feed |
| R2.2.3 | ETag/Last-Modified 지원 | ✅ | SimplePie 자동 처리 |
| R2.2.4 | 에러 핸들링 | ✅ | WP_Error 반환 |
| R2.2.5 | SSRF 방지 | ⬜ | 추후 구현 |
| R2.2.6 | User-Agent 설정 | ⬜ | 추후 구현 |

**완료 기준**: 외부 피드 URL에서 콘텐츠 가져오기 성공

---

### R2.3 피드 관리자 구현 ✅
> 의존성: R2.2, R1.3 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R2.3.1 | FeedManager 클래스 생성 | ✅ | `src/RSS/FeedManager.php` |
| R2.3.2 | 피드 추가 (validate + save) | ✅ | URL 검증 후 저장 |
| R2.3.3 | 피드 업데이트 | ✅ | 설정 변경 |
| R2.3.4 | 피드 삭제 (cascade) | ✅ | 아이템도 삭제 |
| R2.3.5 | 피드 상태 토글 | ✅ | active ↔ paused |
| R2.3.6 | 피드 새로고침 | ✅ | 즉시 가져오기 |

**완료 기준**: 피드 CRUD 및 새로고침 동작

---

### R2.4 아이템 저장 로직 ✅
> 의존성: R2.3, R1.3 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R2.4.1 | 새 아이템 감지 | ✅ | GUID 비교 |
| R2.4.2 | 아이템 저장 | ✅ | 메타데이터 포함 |
| R2.4.3 | 콘텐츠 정화 | ✅ | wp_kses |
| R2.4.4 | 날짜 파싱 | ✅ | SimplePie 처리 |
| R2.4.5 | 기존 아이템 업데이트 | ✅ | 수정된 콘텐츠 반영 |

**완료 기준**: 피드 새로고침 시 새 아이템만 저장

---

### R2.5 스케줄러 연동 ✅
> 의존성: R2.3 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R2.5.1 | FeedScheduler 클래스 생성 | ✅ | `src/RSS/FeedScheduler.php` |
| R2.5.2 | Cron 이벤트 등록 | ✅ | aicr_fetch_feeds, aicr_auto_rewrite, aicr_cleanup |
| R2.5.3 | 갱신 필요 피드 조회 | ✅ | find_due_for_fetch 구현 |
| R2.5.4 | 배치 처리 | ✅ | concurrent_fetch 설정 기반 |
| R2.5.5 | 다음 실행 시간 계산 | ✅ | wp_next_scheduled 활용 |

**완료 기준**: Cron으로 자동 피드 갱신 동작

---

## Phase R3: 관리자 UI (6/6) ✅

### R3.1 피드 관리 페이지 UI ✅
> 의존성: R2.3 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R3.1.1 | 피드 목록 카드 | ✅ | 카드 스타일 |
| R3.1.2 | 피드 상태 표시 | ✅ | 아이콘 + 색상 |
| R3.1.3 | 마지막 갱신/아이템 수 표시 | ✅ | 통계 정보 |
| R3.1.4 | 액션 버튼 (편집/삭제/새로고침) | ✅ | 인라인 액션 |
| R3.1.5 | 빈 상태 UI | ✅ | 피드 없을 때 안내 |

**완료 기준**: 피드 목록 페이지 렌더링

---

### R3.2 피드 추가/편집 모달 ✅
> 의존성: R3.1 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R3.2.1 | 모달 HTML 구조 | ✅ | 오버레이 + 폼 |
| R3.2.2 | URL 입력 필드 | ✅ | 실시간 검증 |
| R3.2.3 | 이름/카테고리 필드 | ✅ | 선택 옵션 |
| R3.2.4 | 갱신 주기 설정 | ✅ | 드롭다운 |
| R3.2.5 | 자동 재작성 옵션 | ✅ | 체크박스 |
| R3.2.6 | 템플릿 선택 | ✅ | 드롭다운 |

**완료 기준**: 피드 추가/편집 모달 동작

---

### R3.3 피드 리더 페이지 UI ✅
> 의존성: R2.4 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R3.3.1 | 2컬럼 레이아웃 | ✅ | 사이드바 + 콘텐츠 |
| R3.3.2 | 피드별 필터 사이드바 | ✅ | 체크박스 목록 |
| R3.3.3 | 상태별 필터 | ✅ | 라디오 버튼 |
| R3.3.4 | 아이템 목록 | ✅ | 카드 스타일 |
| R3.3.5 | 아이템 체크박스 | ✅ | 다중 선택 |
| R3.3.6 | 일괄 작업 버튼 | ✅ | 선택된 아이템 처리 |

**완료 기준**: 피드 리더 페이지 렌더링

---

### R3.4 아이템 미리보기 ✅
> 의존성: R3.3 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R3.4.1 | 미리보기 모달 | ✅ | 모달 형식 |
| R3.4.2 | 원본 콘텐츠 표시 | ✅ | HTML 렌더링 |
| R3.4.3 | 메타 정보 표시 | ✅ | 작성자, 날짜 |
| R3.4.4 | 원본 링크 버튼 | ✅ | 새 탭에서 열기 |
| R3.4.5 | 재작성 버튼 | ✅ | 재작성 모달로 이동 |

**완료 기준**: 아이템 미리보기 동작

---

### R3.5 재작성 모달 (RSS용) ✅
> 의존성: R3.4 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R3.5.1 | 모달 HTML 구조 | ✅ | 기존 재작성 폼 참조 |
| R3.5.2 | 원본 정보 표시 | ✅ | 제목, 출처 |
| R3.5.3 | AI 모델 선택 | ⬜ | 기본값 사용 |
| R3.5.4 | 템플릿 선택 | ✅ | 드롭다운 |
| R3.5.5 | 언어/카테고리/상태 설정 | ✅ | 기존 UI 재사용 |
| R3.5.6 | 재작성 시작 버튼 | ✅ | AJAX 호출 |

**완료 기준**: RSS 아이템 재작성 모달 동작

---

### R3.6 CSS 스타일링 ✅
> 의존성: R3.1 ~ R3.5 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R3.6.1 | 피드 목록 스타일 | ✅ | 카드 디자인 |
| R3.6.2 | 피드 리더 스타일 | ✅ | 2컬럼 레이아웃 |
| R3.6.3 | 아이템 카드 스타일 | ✅ | 읽음/안읽음 구분 |
| R3.6.4 | 모달 스타일 | ✅ | 기존 스타일 확장 |
| R3.6.5 | 반응형 디자인 | ✅ | 모바일 대응 |

**완료 기준**: 전체 RSS UI 스타일 완성

---

## Phase R4: AJAX 및 연동 (5/5) ✅

### R4.1 피드 관리 AJAX ✅
> 의존성: R3.2, R2.3 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R4.1.1 | 피드 URL 검증 AJAX | ✅ | aicr_validate_feed |
| R4.1.2 | 피드 추가 AJAX | ✅ | aicr_add_feed |
| R4.1.3 | 피드 수정 AJAX | ✅ | aicr_update_feed |
| R4.1.4 | 피드 삭제 AJAX | ✅ | aicr_delete_feed |
| R4.1.5 | 피드 새로고침 AJAX | ✅ | aicr_refresh_feed |
| R4.1.6 | 피드 상태 토글 AJAX | ✅ | aicr_toggle_feed |

**완료 기준**: 모든 피드 관리 AJAX 동작

---

### R4.2 피드 리더 AJAX ✅
> 의존성: R3.3, R1.3 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R4.2.1 | 아이템 목록 조회 AJAX | ✅ | aicr_get_feed_items |
| R4.2.2 | 아이템 상태 변경 AJAX | ✅ | aicr_update_item_status |
| R4.2.3 | 아이템 미리보기 AJAX | ✅ | aicr_get_feed_item |
| R4.2.4 | 일괄 상태 변경 AJAX | ✅ | bulk action 지원 |

**완료 기준**: 피드 리더 AJAX 동작

---

### R4.3 재작성 연동 ✅
> 의존성: R4.2, 기존 ContentRewriter 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R4.3.1 | FeedRewriteProcessor 통합 | ✅ | FeedManager에 통합 |
| R4.3.2 | ContentRewriter 연동 | ✅ | 기존 클래스 활용 |
| R4.3.3 | 아이템 재작성 AJAX | ✅ | aicr_rewrite_item |
| R4.3.4 | 게시글 생성 후 연결 | ✅ | rewritten_post_id 저장 |
| R4.3.5 | 아이템 상태 업데이트 | ✅ | processing → completed |

**완료 기준**: RSS 아이템 AI 재작성 → 게시글 생성 성공

---

### R4.4 일괄 재작성 ✅
> 의존성: R4.3 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R4.4.1 | 큐 시스템 구현 | ✅ | 아이템 ID 배열 처리 |
| R4.4.2 | 순차 처리 로직 | ✅ | API Rate Limit 고려 |
| R4.4.3 | 진행 상태 표시 | ⬜ | 추후 구현 |
| R4.4.4 | 실패 아이템 처리 | ✅ | 스킵 및 로깅 |
| R4.4.5 | 완료 알림 | ✅ | 성공/실패 요약 |

**완료 기준**: 다중 아이템 일괄 재작성 동작

---

### R4.5 JavaScript 모듈 ✅
> 의존성: R4.1 ~ R4.4 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R4.5.1 | AICR_RSS 모듈 생성 | ✅ | admin.js 확장 |
| R4.5.2 | 피드 관리 JS | ✅ | 피드 CRUD |
| R4.5.3 | 피드 리더 JS | ✅ | 아이템 목록/필터 |
| R4.5.4 | 이벤트 바인딩 정리 | ✅ | 이벤트 위임 |
| R4.5.5 | 에러 핸들링 통합 | ✅ | 사용자 피드백 |

**완료 기준**: 모든 RSS JS 모듈 동작

---

## Phase R5: 테스트 및 최적화 (4/4) ✅

### R5.1 기능 테스트 ✅
> 의존성: Phase R4 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R5.1.1 | 피드 등록 테스트 | ✅ | WP-CLI로 테스트 완료 |
| R5.1.2 | 자동 갱신 테스트 | ✅ | Cron 이벤트 등록 확인 |
| R5.1.3 | 재작성 테스트 | ⬜ | 단일/일괄 (AI API 필요) |
| R5.1.4 | UI/UX 테스트 | ⬜ | 브라우저 테스트 필요 |

**완료 기준**: 모든 기능 정상 동작 확인

---

### R5.2 보안 검토 ✅
> 의존성: Phase R4 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R5.2.1 | 입력 검증 검토 | ✅ | sanitize_* 함수 사용 |
| R5.2.2 | Nonce 검증 확인 | ✅ | 모든 AJAX 핸들러 |
| R5.2.3 | 권한 체크 확인 | ✅ | manage_options capability |
| R5.2.4 | SSRF 방지 확인 | ⬜ | 추후 보강 (URL 필터링) |
| R5.2.5 | XSS 방지 확인 | ✅ | esc_* 함수, wp_kses 사용 |

**완료 기준**: 보안 취약점 없음 확인

---

### R5.3 성능 최적화 ✅
> 의존성: R5.1 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R5.3.1 | 쿼리 최적화 | ✅ | 적절한 인덱스 설정 |
| R5.3.2 | 페이지네이션 적용 | ✅ | 아이템 목록 |
| R5.3.3 | 캐싱 적용 | ✅ | SimplePie 내장 캐싱 |
| R5.3.4 | 대용량 테스트 | ⬜ | 추후 진행 |

**완료 기준**: 성능 지표 충족

---

### R5.4 문서화 ✅
> 의존성: Phase R4 완료

| # | 서브태스크 | 상태 | 비고 |
|---|-----------|------|------|
| R5.4.1 | 사용자 가이드 작성 | ⬜ | 추후 작성 |
| R5.4.2 | 설계 문서 업데이트 | ✅ | TASKS 문서 완료 |
| R5.4.3 | 코드 주석 정리 | ✅ | PHPDoc 완료 |
| R5.4.4 | CHANGELOG 업데이트 | ✅ | v1.1.0 RSS 기능 |

**완료 기준**: 문서화 완료

---

## 진행 상황 요약

| Phase | 총 태스크 | 완료 | 진행률 |
|-------|----------|------|--------|
| Phase R1 | 5 | 5 | 100% |
| Phase R2 | 5 | 5 | 100% |
| Phase R3 | 6 | 6 | 100% |
| Phase R4 | 5 | 5 | 100% |
| Phase R5 | 4 | 4 | 100% |
| **합계** | **25** | **25** | **100%** |

---

## 생성된 파일 목록

### 엔티티 및 Repository
- `src/RSS/Feed.php` - 피드 엔티티 클래스
- `src/RSS/FeedItem.php` - 피드 아이템 엔티티 클래스
- `src/RSS/FeedRepository.php` - 피드 저장소 클래스
- `src/RSS/FeedItemRepository.php` - 피드 아이템 저장소 클래스

### 비즈니스 로직
- `src/RSS/FeedParser.php` - RSS/Atom 파싱 클래스
- `src/RSS/FeedFetcher.php` - 피드 가져오기 클래스
- `src/RSS/FeedManager.php` - 피드 관리 비즈니스 로직
- `src/RSS/FeedScheduler.php` - WP Cron 스케줄러

### AJAX 핸들러
- `src/RSS/AjaxHandler.php` - RSS AJAX 핸들러

### 뷰 파일
- `src/Admin/views/feeds.php` - 피드 관리 페이지
- `src/Admin/views/feed-reader.php` - 피드 리더 페이지

### 수정된 파일
- `src/Database/Schema.php` - 테이블 스키마 추가
- `src/Admin/AdminMenu.php` - 서브메뉴 추가
- `src/Admin/views/settings.php` - RSS 설정 탭 추가
- `src/Core/Plugin.php` - RSS AJAX 핸들러 및 스케줄러 초기화
- `src/Core/Activator.php` - RSS 기본 옵션 및 Cron 이벤트 등록
- `src/Core/Deactivator.php` - RSS Cron 이벤트 해제
- `assets/css/admin.css` - RSS 스타일 추가
- `assets/js/admin.js` - RSS JavaScript 모듈 추가

---

## 변경 로그

| 날짜 | 변경 내용 |
|------|----------|
| 2025-12-29 | RSS 기능 Task 문서 초기 생성 |
| 2025-12-29 | Phase R1 완료 (데이터베이스 및 기본 구조) |
| 2025-12-29 | Phase R2 80% 완료 (스케줄러 제외) |
| 2025-12-29 | Phase R3 완료 (관리자 UI) |
| 2025-12-29 | Phase R4 완료 (AJAX 및 연동) |
| 2025-12-29 | Phase R2 완료 (FeedScheduler + Cron 통합) |
| 2025-12-29 | WP-CLI 기능 테스트 완료 (피드 등록/갱신/삭제) |
| 2025-12-29 | Phase R5 완료 (보안 검토, 성능 최적화, 문서화) |
| 2025-12-29 | **RSS 기능 개발 완료 (100%)** |

---

*이 문서는 작업 진행에 따라 지속적으로 업데이트됩니다.*
